execute as @e[type=minecraft:marker,tag=xteleporter_a] at @s run function gis:system/item/use_xteleporter_reload


execute unless entity @e[type=minecraft:marker,distance=..0.5,tag=xteleporter_a] run summon minecraft:marker ~ ~ ~ {Tags:["xteleporter_a","xteleporter_red"]}
execute unless predicate gis:system/entity_check/is_sneak as @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_a] run function gis:system/item/use_xteleporter_sub
execute unless predicate gis:system/entity_check/is_sneak run playsound minecraft:ui.button.click block @a ~ ~ ~ 0.5 2

execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_red,tag=xteleporter_a] store result score @s gis_instant1 run execute if entity @e[type=minecraft:marker,tag=xteleporter_red,tag=xteleporter_b]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_blue,tag=xteleporter_a] store result score @s gis_instant1 run execute if entity @e[type=minecraft:marker,tag=xteleporter_blue,tag=xteleporter_b]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_yellow,tag=xteleporter_a] store result score @s gis_instant1 run execute if entity @e[type=minecraft:marker,tag=xteleporter_yellow,tag=xteleporter_b]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_green,tag=xteleporter_a] store result score @s gis_instant1 run execute if entity @e[type=minecraft:marker,tag=xteleporter_green,tag=xteleporter_b]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_pink,tag=xteleporter_a] store result score @s gis_instant1 run execute if entity @e[type=minecraft:marker,tag=xteleporter_pink,tag=xteleporter_b]
execute if predicate gis:system/entity_check/is_sneak run scoreboard players add @s gis_instant1 1
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_red,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=1..2}] [{"text":"チャンネル："},{"text":"red","color":"red"},{"text":"の","color":"reset"},{"score":{"name":"@s","objective":"gis_instant1"}},{"text":"個目のポイントをセットしました"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_blue,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=1..2}] [{"text":"チャンネル："},{"text":"blue","color":"blue"},{"text":"の","color":"reset"},{"score":{"name":"@s","objective":"gis_instant1"}},{"text":"個目のポイントをセットしました"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_yellow,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=1..2}] [{"text":"チャンネル："},{"text":"yellow","color":"yellow"},{"text":"の","color":"reset"},{"score":{"name":"@s","objective":"gis_instant1"}},{"text":"個目のポイントをセットしました"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_green,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=1..2}] [{"text":"チャンネル："},{"text":"green","color":"green"},{"text":"の","color":"reset"},{"score":{"name":"@s","objective":"gis_instant1"}},{"text":"個目のポイントをセットしました"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_pink,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=1..2}] [{"text":"チャンネル："},{"text":"pink","color":"light_purple"},{"text":"の","color":"reset"},{"score":{"name":"@s","objective":"gis_instant1"}},{"text":"個目のポイントをセットしました"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_red,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=3..}] [{"text":"チャンネル："},{"text":"red","color":"red"},{"text":"は既に2箇所とも設定済みです。","color":"reset"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_blue,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=3..}] [{"text":"チャンネル："},{"text":"blue","color":"blue"},{"text":"は既に2箇所とも設定済みです。","color":"reset"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_yellow,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=3..}] [{"text":"チャンネル："},{"text":"yellow","color":"yellow"},{"text":"は既に2箇所とも設定済みです。","color":"reset"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_green,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=3..}] [{"text":"チャンネル："},{"text":"green","color":"green"},{"text":"は既に2箇所とも設定済みです。","color":"reset"}]
execute if predicate gis:system/entity_check/is_sneak if entity @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_pink,tag=xteleporter_a] run tellraw @s[scores={gis_instant1=3..}] [{"text":"チャンネル："},{"text":"pink","color":"light_purple"},{"text":"は既に2箇所とも設定済みです。","color":"reset"}]
execute if predicate gis:system/entity_check/is_sneak run tellraw @s[scores={gis_instant1=3..}] {"text":"ポイントを新しく設定する場合は既に設定したポイントを撤去してください"}
execute if predicate gis:system/entity_check/is_sneak if score @s gis_instant1 matches 1..2 run tag @e[type=minecraft:marker,distance=..0.5,sort=nearest,tag=xteleporter_a] add xteleporter_b
execute if predicate gis:system/entity_check/is_sneak if score @s gis_instant1 matches 1..2 run data modify block ~ ~ ~ Text4 set value '{"text":"«右クリック≫","color":"white","clickEvent":{"action":"run_command","value":"/function gis:system/item/use_xteleporter_b"}}'
execute if predicate gis:system/entity_check/is_sneak if score @s gis_instant1 matches 1..2 run data modify block ~ ~ ~ Text3 set value '{"text":"テレポート","color":"white"}'
scoreboard players reset @s[scores={gis_instant1=1..}] gis_instant1

